Design
======

Core Calculation
----------------
.. code::
   :class: diagram

   +----------------------------+           +---------------------+
   |          Engine            |           |      ZH_L16_GF      |
   +----------------------------+    model  +---------------------+
   | ascent_rate = 10           |x--------->| N2_A                |      calc  +------------------+
   | descent_rate = 20          |      [1]  | N2_B                |x---------->| TissueCalculator |
   | surface_pressure = 1.01325 |           | HE_A                |       [1]  +------------------+
   +----------------------------+           | HE_B                |            | n2_half_life     |
   | add_gas()                  |           | N2_HALF_LIFE        |            | he_half_life     |
   | calculate()                |           | HE_HALF_LIFE        |            |                  |
   +----------------------------+           | gf_low = 0.3        |            +------------------+
                x                           | gf_high = 0.85      |                    /_\
                |                           +---------------------+                     |
                |                           | init()              |                     |
                |                           | load()              |          +-----------------------+
            [1] | conveyor                  | gf_limit()          |          |  TabTissueCalculator  |
                v                           +---------------------+          +-----------------------+
          +------------+                       /_\           /_\
          |  Conveyor  |                        |             |
          +------------+                        |             |
          | time_delta |                +------------+   +------------+
          +------------+                | ZH_L16B_GF |   | ZH_L16C_GF |
                                        +------------+   +------------+


Data Model
----------
.. code::
   :class: diagram

              +------------+                +---------------+      +-------------+
              |   Engine   |                |   ZH_L16_GF   |      |  DecoTable  |
              +------------+                +---------------+      +-------------+
                    |                               |                     |
                    .                               .                     .
                    | <<create>>                    | <<create>>          | <<create>>
                    .                               .                     .
                    |                               |                     |
                    v                               v                     v
               +----------+              data  +----------+          +----------+
               |   Step   |x------------------>|   Data   |          | DecoStop |
               +----------+               [1]  +----------+          +----------+
               | phase    |                    | tissues  |          | depth    |
               | depth    |                    | gf       |          | time     |
               | time     |                    +-----------          +----------+
               | pressure |
               +----------+
                    x
                    |
                    |
                [1] | gas
                    v
                +--------+
                | GasMix |
                +--------+
                | o2     |
                | n2     |
                | he     |
                +--------+

